<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Sign in & Sign up Form</title>
  </head>
  <body>
    <div class="container">
      <div class="forms-container">
        <div class="signin-signup">
          <form action="#" onsubmit="return false" class="sign-in-form">
            <h2 class="title">Sign in</h2>
            <div class="input-field">
              <i class="fas fa-user"></i>
              <input type="text" placeholder="Username" id="userName" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="password" placeholder="Password" id="password" />
            </div>
            <input
              type="submit"
              value="Login"
              class="btn solid"
              id="loginButton"
            />
            <p class="social-text">Or Sign in with social platforms</p>
            <div class="social-media">
              <a href="#" class="social-icon">
                <i class="fab fa-facebook-f"></i>
              </a>
              <a href="#" class="social-icon">
                <i class="fab fa-twitter"></i>
              </a>
              <a href="#" class="social-icon">
                <i class="fab fa-google"></i>
              </a>
              <a href="#" class="social-icon">
                <i class="fab fa-linkedin-in"></i>
              </a>
            </div>

            <!-- google authentication here -->

            <!-- The surrounding HTML is left untouched by FirebaseUI.
     Your app may use that space for branding, controls and other customizations.-->
            <h1>Welcome to My Awesome App</h1>

            <button onclick="myFunction3(event)">Google Auth</button>
            <div id="firebaseui-auth-container"></div>
            <div id="loader">Loading...</div>

            <!-- google authentication here -->
          </form>
          <form action="#" onsubmit="return false" class="sign-up-form">
            <h2 class="title">Sign up</h2>
            <div class="input-field">
              <i class="fas fa-user"></i>
              <input type="text" placeholder="Username" id="userNameSignUp" />
            </div>
            <div class="input-field">
              <i class="fas fa-envelope"></i>
              <input type="email" placeholder="Email" id="emailSignUp" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input
                type="password"
                placeholder="Password"
                id="passwordSignUp"
              />
            </div>
            <input
              type="submit"
              class="btn"
              value="Sign up"
              id="signUpButton"
            />
            <p class="social-text">Or Sign up with social platforms</p>
            <div class="social-media">
              <a href="#" class="social-icon">
                <i class="fab fa-facebook-f"></i>
              </a>
              <a href="#" class="social-icon">
                <i class="fab fa-twitter"></i>
              </a>
              <a href="#" class="social-icon">
                <i class="fab fa-google"></i>
              </a>
              <a href="#" class="social-icon">
                <i class="fab fa-linkedin-in"></i>
              </a>
            </div>

            <h1>This is the code for opt verification</h1>

            <label></label>

            <div id="recaptcha"></div>

            <button onclick="myFunction()">Click</button>
          </form>
        </div>
      </div>

      <div class="panels-container">
        <div class="panel left-panel">
          <div class="content">
            <h3>New here ?</h3>
            <p></p>
            <button class="btn transparent" id="sign-up-btn">Sign up</button>
          </div>
          <img src="img/gift.svg" class="image" alt="" />
        </div>
        <div class="panel right-panel">
          <div class="content">
            <h3>One of us ?</h3>
            <p></p>
            <button class="btn transparent" id="sign-in-btn">Sign in</button>
          </div>
          <img src="img/collab.svg" class="image" alt="" />
        </div>
      </div>
    </div>

    <script
      src="https://kit.fontawesome.com/64d58efce2.js"
      crossorigin="anonymous"
    ></script>

    <!-- Here i am adding the firebase authentication script and link tags -->

    <script src="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js"></script>
    <link
      type="text/css"
      rel="stylesheet"
      href="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css"
    />

    <link rel="stylesheet" href="style.css" />

    <!-- link to implement google login -->

    <script src="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js"></script>
    <link
      type="text/css"
      rel="stylesheet"
      href="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css"
    />

    <!-- link to implement google login -->
    <!-- <script data-main="" src="./scripts/require.js"></script> -->

    <!-- Ultimate cdn links -->
    <script src="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js"></script>
    <link
      type="text/css"
      rel="stylesheet"
      href="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css"
    />
    <!-- Ultimate cdn links -->

    <!-- here i am adding firebase -->

    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-analytics.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>

    <script type="module" src="./app2.js">
      // enabling firebase ui signin with google
    </script>

    <script>
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      var firebaseConfig = {
        apiKey: 'AIzaSyDUC_pEtnlZ2fyg_jy9E_8TcLydhGVK_vw',
        authDomain: 'fir-pds-login.firebaseapp.com',
        projectId: 'fir-pds-login',
        storageBucket: 'fir-pds-login.appspot.com',
        messagingSenderId: '989020340749',
        appId: '1:989020340749:web:948ea252a8348674764b44',
        measurementId: 'G-0KS8EE2XRJ',
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();
      function myFunction3(event) {
        event.preventDefault();

        //   var firebase = require('firebase');
        //   var firebaseui = require('firebaseui');

        var ui = new firebaseui.auth.AuthUI(firebase.auth());

        // Initialize the FirebaseUI Widget using Firebase.
        // var ui = new firebaseui.auth.AuthUI(firebase.auth());
        var uiConfig = {
          callbacks: {
            signInSuccessWithAuthResult: function (authResult, redirectUrl) {
              // User successfully signed in.
              // Return type determines whether we continue the redirect automatically
              // or whether we leave that to developer to handle.

              console.log(' i was inside ') ;
              window.location.href = "http://www.w3schools.com";
              return false;
              // return true;
            },
            uiShown: function () {
              // The widget is rendered.
              // Hide the loader.
              document.getElementById('loader').style.display = 'none';
            },
          },
          // Will use popup for IDP Providers sign-in flow instead of the default, redirect.
          signInFlow: 'popup',
          signInSuccessUrl: 'www.google.com',
          signInOptions: [
            // Leave the lines as is for the providers you want to offer your users.
            firebase.auth.GoogleAuthProvider.PROVIDER_ID,
            firebase.auth.FacebookAuthProvider.PROVIDER_ID,
          ],
          // Terms of service url.
          tosUrl: '<your-tos-url>',
          // Privacy policy url.
          privacyPolicyUrl: '<your-privacy-policy-url>',
        };

        // The start method will wait until the DOM is loaded.
        // ui.start('#firebaseui-auth-container', uiConfig);

        // merging accounts normal and google
        // Temp variable to hold the anonymous user data if needed.
        var data = null;
        // Hold a reference to the anonymous current user.
        var anonymousUser = firebase.auth().currentUser;
        ui.start('#firebaseui-auth-container', {
          // Whether to upgrade anonymous users should be explicitly provided.
          // The user must already be signed in anonymously before FirebaseUI is
          // rendered.
          autoUpgradeAnonymousUsers: true,
          signInSuccessUrl: '/index2.html',
          signInOptions: [
            firebase.auth.GoogleAuthProvider.PROVIDER_ID,
            firebase.auth.FacebookAuthProvider.PROVIDER_ID,
            firebase.auth.EmailAuthProvider.PROVIDER_ID,
            firebase.auth.PhoneAuthProvider.PROVIDER_ID,
          ],
          callbacks: {
            // signInFailure callback must be provided to handle merge conflicts which
            // occur when an existing credential is linked to an anonymous user.
            signInFailure: function (error) {
              // For merge conflicts, the error.code will be
              // 'firebaseui/anonymous-upgrade-merge-conflict'.
              if (error.code != 'firebaseui/anonymous-upgrade-merge-conflict') {
                return Promise.resolve();
              }
              // The credential the user tried to sign in with.
              var cred = error.credential;
              // Copy data from anonymous user to permanent user and delete anonymous
              // user.
              // ...
              // Finish sign-in after data is copied.
              return firebase.auth().signInWithCredential(cred);
            },
          },
        });
      }

      //

      // this is the otp function
      function myFunction() {
        // e.preventDefault() ;
        var recaptcha = new firebase.auth.RecaptchaVerifier('recaptcha');
        var number = '+919407514872';
        firebase
          .auth()
          .signInWithPhoneNumber(number, recaptcha)
          .then(function (e) {
            var code = prompt('Enter the otp', '');

            if (code === null) return;

            console.log('otp verification in process');

            e.confirm(code)
              .then(function (result) {
                console.log(result.user);
                console.log(' i was here inside confirm ' ) ;
                document.querySelector('label').textContent +=
                  result.user.phoneNumber + 'Number verified';
              })
              .catch(function (error) {
                console.error(error);
              });
          })
          .catch(function (error) {
            console.error(error);
          });
      }
    </script>

    <script src="app.js"></script>
  </body>
</html>
